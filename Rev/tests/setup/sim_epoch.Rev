seed(42)

# Get taxa for simulating (100 names and dates of the real taxa)
taxa = readTaxonData("data/reduced_taxa.txt"," ")

# Draw tree
theta <- v(25000,100000,50000)
times <- v(20000,40000)
psi ~ dnHeterochronousCoalescentSkyline(theta=theta,times=times,taxa=taxa)

# Save tree
write(psi,filename="data/epoch.tre")

# Substitution model
clock_rate <- 5.38e-7

Q <- fnJC(4)

seq ~ dnPhyloCTMC(tree=psi,branchRates=clock_rate,Q=Q,nSites=500)

writeNexus("data/epoch.nex",seq)

q()